@**
 * Copyright © 2012 Marek Fišer [malsys@marekfiser.cz]
 * All rights reserved.
 *@
@model GalleryModel

@using Malsys.Processing;
@using Malsys.Web.Models.Lsystem;

@{
	ViewBag.Title = "Gallery of L-systems";
	var serializer = new System.Runtime.Serialization.Formatters.Binary.BinaryFormatter();

	int thnMaxWidth = 512;
	int thnMaxHeight = 256;
	bool loadThreeJs = false;
	IHtmlString pager = Html.Pager(Model.Inputs);
}

<div class="right">@Html.ActionLink("list of tags", MVC.Gallery.Tags())</div>
<h2>Gallery of L-systems</h2>

<div class="clearfix">
@pager
</div>

@if (!string.IsNullOrWhiteSpace(Model.UserFilter)) {
	<p>Filtered by user @Model.UserFilter</p>
}

@if (Model.TagFilter != null) {
	<p>Filtered by tag @Html.Tag(Model.TagFilter.Name) @if (!string.IsNullOrWhiteSpace(Model.TagFilter.Description)) { <text>— @Model.TagFilter.Description</text> }</p>
}

<div class="gallery clearfix">
@foreach (var input in Model.Inputs) {
	var thnModel = new GalleryThumbnailModel() {
		SavedInput = input,
		MaxWidth = thnMaxWidth,
		MaxHeight = thnMaxHeight
	};
	@Html.Partial(MVC.Shared.Views.GalleryThumbnailPartial, thnModel);
	loadThreeJs |= thnModel.NeedsThreeJs;
}
</div>

<div class="clearfix">
@pager
</div>

<p class="note">
	Images on this page are just thumbnails.
	Click them to see the original image, details, ratings and their L-system source code.
</p>

@if (loadThreeJs) {
	<p class="note">
		Note that thumbnails of L-systems in 3D are actual 3D scenes rendered by your browser and you can rotate, zoom or pan them.
	</p>
	<text>
	@section scripts {
		@Content.Js(Links.Js.ThreeJs.Three_js)
		@Content.Js(Links.Js.ThreeJs.Detector_js)
		@Content.Js(Links.Js.ThreeJs.Stats_js)
		@Content.Js(Links.Js.ThreeJs.malsys_three_js)
	}
	</text>
}
